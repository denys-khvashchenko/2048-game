function t(t,e){(null==e||e>t.length)&&(e=t.length);for(var i=0,s=Array(e);i<e;i++)s[i]=t[i];return s}var e=function(){var e;function i(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;!function(t,e){if(!(t instanceof e))throw TypeError("Cannot call a class as a function")}(this,i),this.rows=4,this.columns=4,this.score=0,this.status="playing",this.field=t||[[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0]],this.initializeGame()}return e=[{key:"initializeGame",value:function(){this.findZero()||(this.setRandomNum(),this.setRandomNum()),this.updateView()}},{key:"getState",value:function(){return this.field}},{key:"getScore",value:function(){return this.score}},{key:"getStatus",value:function(){return this.status}},{key:"moveLeft",value:function(){this.slide("left")}},{key:"moveRight",value:function(){this.slide("right")}},{key:"moveUp",value:function(){this.slide("up")}},{key:"moveDown",value:function(){this.slide("down")}},{key:"start",value:function(){this.status="playing",this.restart()}},{key:"restart",value:function(){this.score=0,this.status="playing",this.field=[[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0]],this.setRandomNum(),this.setRandomNum(),this.updateView()}},{key:"updateView",value:function(){s.textContent=this.score;for(var t=0;t<this.rows;t++)for(var e=0;e<this.columns;e++){var i=this.field[t][e],r=document.getElementById("".concat(t,"_").concat(e));r.textContent="",r.classList.value="field-cell",0!==i&&(r.textContent="".concat(i),r.classList.add("field-cell--".concat(i)))}"won"===this.status?o.classList.remove("hidden"):"lost"===this.status?n.classList.remove("hidden"):(o.classList.add("hidden"),n.classList.add("hidden"))}},{key:"findZero",value:function(){for(var t=0;t<this.rows;t++)if(this.field[t].includes(0))return!0;return!1}},{key:"setRandomNum",value:function(){if(this.findZero())for(;;){var t=Math.floor(Math.random()*this.rows),e=Math.floor(Math.random()*this.columns);if(0===this.field[t][e]){var i=.9>Math.random()?2:4;this.field[t][e]=i;break}}}},{key:"slide",value:function(e){var i=this.field.map(function(e){return function(e){if(Array.isArray(e))return t(e)}(e)||function(t){if("undefined"!=typeof Symbol&&null!=t[Symbol.iterator]||null!=t["@@iterator"])return Array.from(t)}(e)||function(e,i){if(e){if("string"==typeof e)return t(e,void 0);var s=Object.prototype.toString.call(e).slice(8,-1);if("Object"===s&&e.constructor&&(s=e.constructor.name),"Map"===s||"Set"===s)return Array.from(s);if("Arguments"===s||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(s))return t(e,void 0)}}(e)||function(){throw TypeError("Invalid attempt to spread non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()});switch(e){case"left":for(var s=0;s<this.rows;s++){var r=this.field[s];this.field[s]=this.slideRow(r)}break;case"right":for(var n=0;n<this.rows;n++){var o=this.field[n].slice().reverse();o=this.slideRow(o).reverse(),this.field[n]=o}break;case"up":for(var a=0;a<this.columns;a++){var l=[this.field[0][a],this.field[1][a],this.field[2][a],this.field[3][a]];l=this.slideRow(l);for(var u=0;u<this.rows;u++)this.field[u][a]=l[u]}break;case"down":for(var d=0;d<this.columns;d++){var c=[this.field[0][d],this.field[1][d],this.field[2][d],this.field[3][d]].reverse();c=this.slideRow(c).reverse();for(var f=0;f<this.rows;f++)this.field[f][d]=c[f]}}this.identicalFields(i,this.field)||(this.setRandomNum(),this.updateView()),this.canMove()||(this.status="lost",this.updateView())}},{key:"slideRow",value:function(t){for(var e=t.filter(function(t){return 0!==t}),i=0;i<e.length-1;i++)e[i]===e[i+1]&&(e[i]*=2,e[i+1]=0,this.score+=e[i]);for(e=e.filter(function(t){return 0!==t});e.length<this.columns;)e.push(0);return e}},{key:"canMove",value:function(){if(this.findZero())return!0;for(var t,e=0;e<this.rows;e++)for(var i=0;i<this.columns;i++)if(this.field[e][i]===this.field[e][i+1]||this.field[e][i]===(null===(t=this.field[e+1])||void 0===t?void 0:t[i]))return!0;return!1}},{key:"identicalFields",value:function(t,e){for(var i=0;i<this.rows;i++)for(var s=0;s<this.columns;s++)if(t[i][s]!==e[i][s])return!1;return!0}}],function(t,e){for(var i=0;i<e.length;i++){var s=e[i];s.enumerable=s.enumerable||!1,s.configurable=!0,"value"in s&&(s.writable=!0),Object.defineProperty(t,s.key,s)}}(i.prototype,e),i}(),i=document.querySelector(".button"),s=document.querySelector(".game-score"),r=document.querySelector(".message-start"),n=document.querySelector(".message-lose"),o=document.querySelector(".message-win"),a=new e;i.addEventListener("click",function(){a.start(),i.blur(),i.classList.add("restart"),i.classList.remove("start"),i.textContent="Restart",r.classList.add("hidden"),o.classList.add("hidden"),n.classList.add("hidden")}),document.addEventListener("keydown",function(t){"playing"===a.status&&("ArrowLeft"===t.code&&a.moveLeft(),"ArrowRight"===t.code&&a.moveRight(),"ArrowUp"===t.code&&a.moveUp(),"ArrowDown"===t.code&&a.moveDown(),s.textContent="".concat(a.getScore()))});
//# sourceMappingURL=index.511e8c1b.js.map
